<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>HiveGo - Hive game and AI implemented in Go</title>
    <link rel="icon" href="assets/Icon.png"/>
    <link href="https://fonts.googleapis.com/css?family=Indie+Flower" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Indie+Flower&display=swap/" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css?family=Oswald" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"/>
    <link rel="stylesheet" href="./assets/style.css"/>

	<script
	  src="https://code.jquery.com/jquery-2.2.4.min.js"
	  integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
	  crossorigin="anonymous"></script>
    <script src="./wasm/wasm_exec.js"></script>
    <script>
        async function runWasm() {
            try {
                if (!WebAssembly.instantiateStreaming) { // polyfill
                    WebAssembly.instantiateStreaming = async (resp, importObject) => {
                        const source = await (await resp).arrayBuffer();
                        return await WebAssembly.instantiate(source, importObject);
                    };
                }

                const go = new Go();
                const importObject = go.importObject;

                const response = await fetch('./wasm/main.wasm');
                const result = await WebAssembly.instantiateStreaming(response, importObject);
                go.run(result.instance);

                // Assuming your Go/Wasm code has a 'main' function that is now executed by go.run()

            } catch (e) {
                console.error("Error loading and running Wasm:", e);
            }
        }

        runWasm();
    </script>
</head>
<body>
	<svg id="svg_canvas" class="fullscreen" style="background: #F0ED8B;">
    <defs id="svg_defs"></defs>
	</svg>

    <div id="splashScreen" style="display:none; /* Initially hidden */" tabindex="0">
        <h1 style="">hiveGo</h1>
        <div id="github_link" style="text-align: center; margin-top: 0px;">
            <a href="https://github.com/janpfeifer/hiveGo" target="_blank">ðŸ”— github.com/janpfeifer/hiveGo ðŸ”—</a>
        </div>
        <div id="splash-image-container" class="splash-image-container">
            <img id="splash-image" src="./assets/Grasshopper.png" alt="Splash Screen">
        </div>
    </div>

    <div id="new_game" class="fullscreen" style="display: none;">
        <div class="dialog">
            <form>
                <h3>New Game</h3>
                <label>
                    <input type="radio" name="game_type" id="game_vs_ai" value="ai" checked>
                    Play with AI
                </label>
                <label>
                    <input type="radio" name="game_type" id="hotseat" value="hotseat">
                    Play with a friend ("hotseat")
                </label>

                <h3>AI Settings</h3>
                <label>
                    <input type="radio" name="ai_level" id="easy" value="Easy" checked>
                    Easy
                </label>
                <label>
                    <input type="radio" name="ai_level" id="medium" value="Medium">
                    Medium
                </label>
                <label>
                    <input type="radio" name="ai_level" id="hard" value="Hard">
                    Hard
                </label>

                <label>
                    <input type="checkbox" name="ai_starts" id="ai_starts">
                    AI plays first
                </label>

                <p>Advanced AI config:</p>
                <p><input type="text" name="ai_config" id="ai_config" value=""></p>
                <p><button type="submit" id="start">Start</button></p>
            </form>
        </div>

        <div class="floating-video-container">
            <video class="floating-video" src="./assets/robot.mp4" autoplay loop muted></video>
            <div class="powered-by">
                Powered by <a href="https://github.com/gomlx/gomlx" target="_blank" rel="noopener noreferrer">GoMLX</a>
            </div>
        </div>

    </div>

    <img src="assets/busy.gif" id="busy" class="busy_class" style="display: none;" width="64" height="64"/>
</body>
</html>